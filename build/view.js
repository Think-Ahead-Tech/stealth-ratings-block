document.querySelectorAll(".wp-block-stealth-ratings-block-stealth-ratings-block").forEach(((e,t)=>{const n=e.querySelectorAll(".star"),s=e.querySelector(".stealth-ratings-form"),i=e.querySelector(".stealth-ratings-success"),a=e.querySelector(".stealth-ratings-redirect"),r=e.querySelector(".stealth-ratings-caption"),l=e.dataset.businessName||"",o=e.dataset.externalUrl||"",d=parseInt(e.dataset.threshold,10)||4;let c=0,y=!1;function u(e=0){n.forEach(((t,n)=>{e?t.classList.toggle("filled",n<e):t.classList.toggle("filled",n<c)}))}n.forEach(((e,t)=>{e.addEventListener("mouseenter",(()=>u(t+1))),e.addEventListener("mouseleave",(()=>u())),e.addEventListener("focus",(()=>u(t+1))),e.addEventListener("blur",(()=>u())),e.addEventListener("click",(()=>{y||(c=t+1,u(),r.style.display="none",c<d?(s.style.display="",i.style.display="none",a.style.display="none"):o&&setTimeout((()=>{window.location.href=o}),1500))})),e.addEventListener("keydown",(t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.click())})),e.setAttribute("tabindex","0")})),s&&s.addEventListener("submit",(function(e){e.preventDefault();const t=s.querySelector('input[name="name"]').value,n=s.querySelector('textarea[name="feedback"]').value;s.querySelector('button[type="submit"]').disabled=!0,fetch("/wp-json/stealth-ratings/v1/send-feedback",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.StealthRatingsBlock&&window.StealthRatingsBlock.nonce?window.StealthRatingsBlock.nonce:""},body:JSON.stringify({name:t,message:n,rating:c})}).then((e=>e.json())).then((e=>{if(!e||!e.success)throw new Error("Submission failed");s.style.display="none",i.style.display="",a.style.display="none",i.innerHTML=`\n              <div class="components-notice is-success stealth-ratings-success-message" style="margin-top:2rem;text-align:center;">\n                <div style="font-size:1.6rem;line-height:1;margin-bottom:0.5rem;">âœ…</div>\n                <div style="font-size:1.15rem;font-weight:600;">Feedback Received</div>\n                <div style="margin:1rem 0 0.5rem 0;">Thank you${t?", "+t:""}!</div>\n                <div style="font-size:1rem;line-height:1.4;">Your feedback has been received and will help <b>${l}</b> improve.<br>We appreciate you taking the time to share your thoughts with us.</div>\n              </div>\n            `})).catch((()=>{i.style.display="",i.innerHTML='<div class="components-notice is-error" style="margin-top:2rem;text-align:center;">\n            <div style="font-size:1.2rem;font-weight:600;">Submission failed</div>\n            <div style="margin:1rem 0 0.5rem 0;">Sorry, there was a problem sending your feedback. Please try again later.</div>\n          </div>'})).finally((()=>{s.querySelector('button[type="submit"]').disabled=!1,y=!0}))}))}));